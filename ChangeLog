2002-05-05 02:54  andy

	* main.c:

	main.c:
		Apparently using _exit is the correct thing to do.
	
2002-05-04 19:48  strtok

	* bopm.conf.sample, config.c, extern.h, scan.c:

	
	scan.c, config.c, extern.h, bopm.conf.sample: Added CONF_TIMEOUT and TIMEOUT
	          directive to allow for configurable scan timeouts (suggested by lilo).
	
2002-05-01 18:44  andy

	* irc.c, bopm.conf.sample, config.c, extern.h:

	irc.c, config.c, extern.h:
		Added config option REALNAME which allows bopm's IRC "realname" to
		be configured.
	
	bopm.conf.sample:
		Sample REALNAME
	
2002-05-01 17:58  andy

	* stats.c, stats.h:

	stats.c, stats.h:
		Reformatiing
	
2002-05-01 05:01  andy

	* scan.c, scan.h:

	scan.c, scan.h:
		Reformatting.
	
2002-05-01 00:24  andy

	* irc.c, opercmd.c, opercmd.h:

	opercmd.c:
		Reformatting.
	opercmd.h:
		Reformatting, moved some global variable declarations to opercmd.c
	irc.c:
		Needed an extern to get access to LAST_REAP_TIME.
	
2002-04-30 23:41  andy

	* misc.c, misc.h:

	misc.c, misc.h:
		Reformatting.
	
2002-04-30 22:53  andy

	* main.c:

	main.c:
		Reformatting.
	
2002-04-30 21:14  andy

	* log.c, log.h:

	log.c, log.h:
		Reformatting.
	
2002-04-30 04:01  andy

	* irc.c, irc.h:

	irc.c:
		Code cleanups.  Added check_channel() function to check if a given
		channel is one of our configured reporting channels.  Made a bunch
		of irc.c private fucntions have static linkage.
	irc.h:
		Code cleanups.
	
2002-04-30 01:37  andy

	* dnsbl.c, extern.h, log.c, misc.c, opercmd.c, stats.c:

	extern.h:
		Code format cleanup.  Move include of config.h to files that need
		it.
	
	dnsbl.c, log.c, misc.c, opercmd.c, stats.c:
		Add include for config.h.
	
2002-04-29 18:10  strtok

	* bopm.conf.sample:

	
	bopm.conf.sample: Fixed TARGET_STRING sample
	
2002-04-29 17:17  andy

	* dnsbl.c, dnsbl.h:

	dnsbl.c:
		Formatting cleanup & added more descriptive error message when
		gethostbyname() fails (is man page wrong?)
	
	dnsbl.h:
		Formatting cleanup.
	
2002-04-29 15:20  andy

	* config.c:

	config.c:
		Doh, KEYS is not required for normal operation.
	
2002-04-29 15:18  andy

	* bopchecker.h:

	bopchecker.h:
		Open cisco router bit mask.
	
2002-04-29 15:15  andy

	* config.c, config.h:

	config.c:
		Tidied up indentation.
	
		Added static linkage for all private config functions.
	
		Added add_to_list() to simplify adding values to configuration
		lists.
	
		Added free_list() to simplify clearing out each config list at
		startup/rehash.
	
		Added add_to_config() to simplify adding a key/value pair to our
		config hash.
	
	config.h:
		Neater indentation, some prototypes moved to config.c.
	
2002-04-29 06:57  strtok

	* scan.c:

	
	scan.c: Uncommented CISCO from scan table as efnet reports it is working
	        properly
	
2002-04-28 19:20  andy

	* bopchecker.c, bopchecker.h:

	Code clean up.
	
2002-04-28 18:35  andy

	* bopchecker.c, config.c, extern.h, irc.c, main.c, misc.c,
	opercmd.c, opercmd.h, scan.c, stats.c:

	bopchecker.c:
		Hacks to avoid unused variable warnings.
	config.c:
		Code cleanups.
	extern.h:
		Code cleanups.
	irc.c:
		Code cleanups.
	main.c:
		Merged singal handlers into one function, code cleanups.
	misc.c:
		Code cleanups.
	opercmd.c, opercmd.h:
		2nd parameter of checkoper was never used.
	scan.c:
		Code cleanups.
	stats.c:
		Code cleanups.
	
2002-04-26 23:20  andy

	* bopm.conf.sample:

	bopm.conf.sample:
		Better example config suggestion from Erik / Andrew Church.
	
2002-04-26 22:32  andy

	* bopm.conf.sample, config.c, extern.h, irc.c:

	config.c, bopm.conf.sample:
		Added KEYS config parameter.
	
	irc.c:
		Added support for channel keys, plus helper function get_chan_key()
		which looks up the correct key for a given channel.
	
2002-04-25 22:27  strtok

	* scan.c:

	
	scan.c: Commented HTTP 8000 out of the scan table, those who wish to scan
	        on this port can easily uncomment it.
	
2002-04-25 07:24  strtok

	* scan.c:

	
	scan.c: Removed use of scan_del() where STATE_CLOSED should have been set
	        instead.
	
2002-04-25 05:41  strtok

	* options.h, scan.c:

	
	scan.c/options.h: Added MAXREAD (default 4096), max amount of bytes read from
	         any port before the connection is considered a flood and failed.
	
2002-04-25 05:17  strtok

	* scan.c:

	
	scan.c: Fixed bug which caused freezing if data was virtually endless (reported
	       by qurve/qeast
	
2002-04-25 03:42  strtok

	* scan.c:

	
	scan.c: Fixed scan_struct data bug where it tried to free data even if
	it wasn't malloc yet.
	
	scan.c: Commented out cisco and http port 8001 scanning, because servers will
	be using this commit live.
	
2002-04-24 12:43  andy

	* bopm.conf.sample:

	bopm.conf.sample:
		Less Blitzed-like pages from Tom Gilder <tom@blitzed.org>
	
2002-04-23 17:56  andy

	* irc.c, irc.h:

	irc.c:
		Here's support for ultimate ircd.
	
2002-04-18 00:25  andy

	* README, main.c, options.h:

	main.c, options.h:
		-v option from Harald Skoglund <harald@hekta.stud.iet.hist.no>
	
	README:
		Documentation of command line options.
	
2002-04-17 23:16  andy

	* bopm.conf.sample:

	README:
		Again some notes added for SCANPORT because lots of people are having a
		hard time understanding what this is for.
	
2002-04-14 12:03  dgl

	* README:

	typo, the hybrid team didn't write math.[ch] :)
	
2002-04-11 05:56  andy

	* scan.c:

	scan.c:
		So much call for HTTP scanning on ports 8000, 8001.  Well, let's
		try it for a while and see.
	
2002-04-04 03:32  andy

	* bopm.conf.sample:

	bopm.conf.sample:
		Many people appear to be getting confused over this.
	
2002-03-31 20:33  andy

	* README:

	Strange Unrealism.
	
2002-03-31 06:31  andy

	* README:

	Mailman moved to a slightly simpler URL.
	
2002-03-21 17:23  andy

	* README:

	More IRCu notes from wunix <wu@wunix.org>
	
2002-03-19 13:25  andy

	* README:

	README:
		Some compatibility notes from Erik Fears <strtok@softhome.net>
	
2002-03-03 21:49  andy

	* configure, configure.in:

	configure.in:
		Added DNSBL begging text
	
2002-02-26 05:07  strtok

	* scan.c:

	scan.c: Moved Cisco up in hash table so that it is tried before wingate,
	because cisco routers only allow 4 connections at once (pointed out by JPayne)
	
2002-02-25 07:16  strtok

	* scan.c:

	
	scan.c: Cisco scanning now works
	
2002-02-25 07:08  strtok

	* version.h:

	version.h: Incremented version to 2.2 so we can identify any bopms that have cvs updated
	
2002-02-25 07:07  strtok

	* scan.c:

	scan.c: Actually send() data for cisco check now (oops)
	
2002-02-25 06:57  strtok

	* scan.c, scan.h:

	scan.c/scan.h: Added open cisco router scanning
	
2002-02-22 11:06  andy

	* README:

	README:
		Credits for Collide.
	
2002-02-22 11:05  andy

	* irc.c, irc.h:

	irc.c:
		Added three new functions, do_hybrid_connect(), do_xnet_connect()
		and do_trircd_connect().  This could be modularised further but for
		now this gets rid of some duplication.  Each function is for
		processing the connect notices of different classes of ircd.
	
		do_trircd_connect() adds support for tr-ircd, which has a &connects
		channel instead of a +c umode.
	
2002-02-19 23:29  andy

	* ChangeLog:

	ChangeLog:
		Update dfor next release
	
2002-02-19 23:10  andy

	* configure, configure.in:

	configure.in:
		$ac_c deprecated
	
2002-02-19 23:04  andy

	* configure, configure.in:

	configure.in:
		Fix broken "echo -n" check
	
2002-02-19 23:00  andy

	* configure, configure.in, setup.h.in:

	configure.in:
		Fix sys/poll.h check
	
2002-02-19 22:57  andy

	* acconfig.h, configure, configure.in, setup.h.in:

	configure.in:
		Get rid of need for acconfig.h
	acconfig.h:
		No longer needed
	
2002-02-19 20:55  strtok

	* version.h:

	version.h: Incremented version to 2.1
	
2002-02-19 20:46  strtok

	* scan.c:

	Fix for select()
	
2002-02-17 17:15  andy

	* README:

	README:
		Some credits we missed, oops.
	
2002-02-17 03:52  andy

	* ChangeLog:

	[no log message]
	
2002-02-17 02:35  andy

	* irc.c:

	irc.c:
		Doh!  Need to check we have enough tokens before blindly accessing
		tokens[6].
	
2002-02-16 18:44  andy

	* ChangeLog:

	[no log message]
	
2002-02-16 18:43  andy

	* configure, configure.in:

	configure.in:
		Added a bit about using GNU Make.
	
2002-02-16 18:37  andy

	* ChangeLog:

	[no log message]
	
2002-02-16 18:36  strtok

	* config.c:

	config.c: Fixed -> typo
	
2002-02-16 18:35  strtok

	* config.c:

	config.c: DEBUG level 3 now also prints out LISTS with other config elements
	
2002-02-16 18:17  andy

	* ChangeLog:

	ChangeLog:
		Idea - let's remove changes to the changelog, from the changelog. :)
	
2002-02-16 18:16  andy

	* ChangeLog:

	ChangeLog:
		Updated again..
	
2002-02-16 06:18  strtok

	* config.c:

	Added code to free TYPE_LIST in config.c (someone forgot this!)
	
2002-02-16 03:23  andy

	* ChangeLog:

	ChangeLog:
		Updated for next release.
	
2002-02-15 23:21  andy

	* bopm.conf.sample:

	bopm.conf.sample:
		Added docs and examples for EXCLUDE option.
	
2002-02-15 04:57  andy

	* Makefile.in, config.c, config.h, extern.h, irc.c, irc.h, match.c,
	match.h, scan.c:

	
	match.c, match.h:
	IRC wildcard matching functions from dancer-hybrid.  match()
	handles string matching and collapse() shortens a wildcard string
	as far as possible.
	
	config.h:
	Added new config type; TYPE_LIST.  Multiple parameters of this
	type are put into a linked list.
	
	Added missing config_memfail() prototype.
	
	config.c:
	Added new config option EXCLUDE.  This is a list of wildcard
	strings against which the host and IP address of connecting users
	will be matched.  A user which matches any entry will not be
	scanned.
	
	Makefile.in:
	Added new objects and dependencies for match.[cho]
	
	irc.c, irc.h:
	Added do_connect() function to avoid duplication.  This function
	checks the users host and IP address against the EXCLUDE list and
	provided there are no matches proceeds to do a DNSBL check and
	proxy scan.
	
	The above patch was contributed by Rob Levin/lilo @ OPN
	
2002-02-15 00:56  andy

	* Makefile.in, misc.c, opercmd.c, scan.c, stats.c:

	Makefile.in, misc.c, stats.c:
		Forogt to include the autoconfiscated header
	
	opercmd.c, scan.c:
		Small tidyup.
	
2002-02-14 05:56  andy

	* INSTALL, README:

	README:
		Updated mailing list info, credits, etc.
	INSTALL:
		Largely rewritten installation instructions and a blurb about
		TARGET_STRING
	
2002-02-14 05:17  andy

	* acconfig.h, configure, configure.in, irc.c, options.h,
	setup.h.in:

	configure.in, options.h:
		Added configure option --with-unreal to replace the UNREAL
		definition that was in options.h
	acconfig.h:
		Make autoheader work for --with-unreal
	irc.c:
		WITH_UNREAL instead of UNREAL
	
2002-02-14 05:06  andy

	* acconfig.h, configure, configure.in, setup.h.in:

	configure.in:
		Added support for --with-select configure option so that people
		can force use of select() whether they have poll() or not.
	acconfig.h:
		This makes autoheader work (which is used to make setup.h.in from
		configure.in) now that WITH_SELECT is added.
	
2002-02-14 01:51  andy

	* configure, configure.in, options.h, scan.c, setup.h.in:

	configure.in:
		Check for sys/poll.h
	options.h:
		We'll use poll() if sys/poll.h was found
	scan.c:
		Alter for autoconfiscated sys/poll.h check.
	
2002-02-13 23:52  andy

	* configure, configure.in, dnsbl.c, setup.h.in:

	configure.in:
		Add a check for bigendian systems.
	dnsbl.c:
		If we're on a bigendian system this'll be backwards.
	
2002-02-13 22:28  andy

	* Makefile.in, configure:

	OK, so we do need to distribute configure.
	
2002-02-13 22:15  strtok

	* scan.c, scan.h:

	Added byte counter to teach connection, and adjusted manual check output to be be more informative
	
2002-02-13 20:50  andy

	* bopchecker.c, irc.c, scan.c:

	bopchecker.c, irc.c, scan.c:
		Use AC_HEADER_TIME and AC_CHECK_HEADERS(sys/time.h) to check how to
		handle time.h and sys/time.h (if there even if a sys/time.h, if it
		can be included with time.h)
	
2002-02-13 20:32  andy

	* bopchecker.c:

	bopchecker.c:
		Another STDC_HEADERS check
	
2002-02-13 20:28  andy

	* config.c:

	config.c:
		Typo fix.
	
2002-02-13 20:26  andy

	* Makefile.in, config.c, dnsbl.c, irc.c, log.c, main.c, opercmd.c,
	scan.c:

	Makefile.in:
		Add a distclean target.  We may want to distribute the configure
		script at some point instead of just configure.in and expect people
		to use autoconf; we'll have to remember to change this then.
	
	config.c, dnsbl.c, irc.c, log.c, main.c, opercmd.c, scan.c:
		Take account of AC_HEADER_STDC check.
	
2002-02-13 20:12  andy

	* main.c:

	main.c:
		Handle AC_TYPE_SIGNAL check.
	
2002-02-13 19:58  andy

	* setup.h.in:

	setup.h.in:
		/me reads as far as "autoheader" in the autoconf manual.
	
2002-02-13 19:24  andy

	* Makefile, Makefile.in, configure.in, setup.h.in:

	First stab at autoconfiscation (euheue)
	
2002-02-13 16:51  andy

	* bopchecker.c:

	bopchecker.c:
		bopchecker needs a target string as well now.
	
2002-02-13 05:40  strtok

	* scan.c:

	Pad scan_struct->data + 1 byte on malloc to leave room for null terminator (was causing buffer overrun)
	
2002-02-12 23:02  andy

	* config.c:

	config.c:
		Really doesn't need to be that verbose :)
		Remember I use -d and -dd a lot when helping people set up BOPM -
		I really don't need 2 pages of config options flying by.
	
2002-02-12 21:42  strtok

	* version.h:

	VERSION for this release will be 2.0
	
2002-02-12 21:17  strtok

	* scan.c:

	Wingate write function now actually sends data
	
2002-02-12 21:07  strtok

	* scan.c, scan.h:

	Cleaned out code no longer needed
	
2002-02-12 20:57  strtok

	* bopm.conf.sample:

	Added TARGET_STRING to config file
	
2002-02-12 20:54  strtok

	* config.c, extern.h, options.h, scan.c, scan.h:

	No longer use individual read functions for each protocol, now search for
	a TARGET_STRING within the data. (set in conf)
	
2002-02-12 19:19  strtok

	* bopm.conf.sample, options.h, scan.c, scan.h:

	options.h USE_POLL and MAXPOLL for use of poll() as opposed to select() in
	          scan.c. If USE_POLL is defined, the scanner will use poll(), if not
	          select() is used as before
	
2002-02-12 06:10  strtok

	* bopm.conf.sample, config.c, extern.h, misc.c, scan.c, scan.h:

	bopm.conf.sample: Added config parameter FDLIMIT (default 512), which is maximum number
	    of file descriptors that can be open at any time (for scanning).
	config.c: Added -d debug output of set config parameters
	misc.c: Fixed bug involving clean()
	scan.c: Added scan_establish() code to socket()/connect() to a socket, connections
	        are now queued if the FDLIMIT cap is reached.
	
2002-02-10 15:37  andy

	* README:

	README:
		Credits for recent patches.
	
2002-02-10 15:25  andy

	* scan.c:

	scan.c:
		Improved HTTP handling.  Seems to work (have tested against all
		known HTTP false positives seen so far, plus 2 known open proxies).
		Ideas and pseudocode from jpayne@blitzed.org.
	
2002-02-10 14:34  andy

	* irc.c, irc.h, main.c:

	irc.c:
	irc.h:
		Added a MSGLEN #define so that networks which use different sized
		IRC buffers can be made to work easily.
	
	main.c:
		Changed umask to something more sensible.
	
	Both the above from shasta@irc.pl.
	
2002-02-07 17:23  andy

	* bopm.conf.sample, dnsbl.c:

	dnsbl.c:
		Need to check against DNSBL_ZONE with a dot on the end, because
		otherwise it will try the search domains in /etc/resolv.conf, and may
		even find a match!  Reported and fixed by asmodeus@irc.gr
	
	bopm.conf.sample:
		Gotcha about putting your own dot at the end of the zone.
	
2002-02-04 22:39  andy

	* bopchecker.c:

	bopchecker.c:
		Extra #include needed, reported by shasta@irc.pl
	
2002-02-04 18:12  andy

	* stats.c:

	stats.c:
		Added simple connects/minute reading.
	
2002-02-01 06:17  andy

	* ChangeLog:

	ChangeLog:
		Updated for next realese.
	
2002-02-01 06:16  andy

	* README:

	README:
		Added note about Unreal 3.2 support.
	
2002-02-01 05:57  andy

	* Makefile:

	Makefile:
		irc.o depends on options.h
	
2002-02-01 05:08  andy

	* README:

	README:
		Credits to locksmith for his help.
	
2002-02-01 04:40  andy

	* config.c:

	config.c:
		Possible stupid error with calculating size of config hash.
	
2002-01-31 06:00  strtok

	* irc.c:

	irc.c: Last commit had an odd paste from vim (???)
	
2002-01-31 05:38  strtok

	* config.c, irc.c, scan.h:

	config.c: Added FDLIMIT configuration parameter (limit of open file descriptors)
	irc.c: Fixed NULL CONF_NICKSERV_IDENT pointer (reported by uneks)
	scan.h: Added STATE_UNESTABLISHED
	
2002-01-30 23:55  andy

	* irc.c:

	irc.c:
		Some ircd's (Xnet and others?) don't send +c notices with the server as
		the source.
	
2002-01-29 17:33  andy

	* ChangeLog:

	ChangeLog:
		Updated for next release.
	
2002-01-29 17:31  andy

	* config.c:

	config.c:
		Now we've added a zero element on the config hash we need to adjust
		the sizes..
	
2002-01-29 01:49  strtok

	* README:

	README: Added codebase specific compatibility (those tested)
	
2002-01-29 01:46  andy

	* ChangeLog:

	ChangeLog:
		Missed a late commit.
	
2002-01-29 01:45  andy

	* bopm.conf.sample:

	bopm.conf.sample:
		Added suggestion from Sotiris Tsimbonis to make ti a bit more
		obvious that a temporary KLINE should be used.
	
2002-01-29 01:25  andy

	* ChangeLog:

	ChangeLog:
		Updated ChangeLog for 1.1 release.
	
2002-01-29 01:21  strtok

	* version.h:

	Version.h: Now 1.1
	
2002-01-29 00:23  andy

	* bopchecker.c, bopchecker.h, config.c:

	bopchecker.c:
		Some reorganisation.
	
		"req" field of config hash is now zero'd for all but the parameters
		we need for bopchecker to operate.
	
		Used a sleep(1) to reduce CPU usage.
	
	bopchecker.h:
		Exit values have changed again!  0 and 1 are already in use within
		bopm, so now 15-255 are reserved for bopchecker.
	
		HTTP    =  16
		WinGate =  32
		SOCKS4  =  64
		SOCKS5  = 128
	
	config.c:
		Terminated the config hash with a zero'd entry so that it is easy
		to tell where it ends.
	
2002-01-29 00:15  strtok

	* README, config.c:

	README: Added rehash instructions
	
2002-01-28 01:37  andy

	* README:

	README:
		Credits for PASSWORD option
	
2002-01-28 01:33  andy

	* bopm.conf.sample, config.c, extern.h, irc.c:

	config.c, extern.h:
		Add PASSWORD config option.
	irc.c:
		Use PASSWORD if supplied.
	bopm.conf.sample:
		Document PASSWORD, fix typo on SERVER
	
2002-01-28 00:18  strtok

	* config.c, config.h:

	config.c/config.h: BOPM now exits if 'required' configuration parameters
	are not set.
	
2002-01-27 14:17  andy

	* bopchecker.c, bopchecker.h:

	bopchecker.h:
		Added bitmasks for the types of proxy.  HTTP is 1, Wingate 2,
		SOCKS4 is 4 and SOCKS5 8.
	
	bopchecker.c:
		Now returns a bitmask of the types of proxies found back to the
		shell. THIS MEANS THAT VALUES > 1 MEAN A PROXY WAS FOUND AND 0
		MEANS NO PROXY WAS FOUND, THIS IS THE EXACT OPPOSITE TO PRIOR
		VERSIONS OF THIS PROGRAM!
	
2002-01-27 04:23  strtok

	* irc.c:

	irc.c: Fixed segfault if nickserv ident isnt defined in conf
	
2002-01-26 19:17  strtok

	* config.c:

	config.c: Replace C++ comment with C style comment (oops)
	
2002-01-25 22:58  andy

	* bopm.conf.sample:

	bopm.conf.sample:
		Remove Blitzed address because of people sending us reports without
	        contacting us.
	
2002-01-25 22:02  andy

	* scan.c:

	scan.c: Suggestion from Sotiris Tsimbonis that details go to channels
	
2002-01-25 21:14  andy

	* README, bopm.conf.sample, dnsbl.c:

	dnsbl.c: Allow reporting to multiple addresses
	README: Note about Sotiris Tsimbonis' idea
	bopm.conf.sample: Note about how to use multiple TO addresses
	
2002-01-25 15:27  andy

	* irc.c:

	irc.c: support & channels, bug found by Sotiris Tsimbonis <stsimb@irc.gr>.
	
2002-01-24 21:54  strtok

	* INSTALL:

	INSTALL: Updated INSTALL file to include information about options.h
	
2002-01-24 21:53  strtok

	* irc.c, options.h:

	irc.c/options.h: Added support for unreal ircds
	
2002-01-24 17:40  strtok

	* README:

	README: Added hybrid compatibility to README.
	
2002-01-24 10:41  andy

	* bopm.conf.sample, config.c, extern.h, irc.c:

	Added OPER_MODES config option to specify what modes the bopm will set on
	itself after opering up.
	
2002-01-24 06:56  andy

	* bopchecker.c:

	bopchecker needs to time out too, doh.
	
2002-01-24 06:18  andy

	* extern.h:

	Remove CONF_PING, a config option that never was.
	
2002-01-24 06:07  andy

	* INSTALL, README, bopchecker.c, extern.h, irc.c, main.c,
	options.h:

	Merged patch from Sotiris Tsimbonis <stsimb@irc.gr> with minor changes.
	Adds a -c command line argument which tells bopm to use a different name
	for log, pid and config files.  i.e. ./bopm -c myserver will use
	myserver.conf, myserver.log, myserver.pid.
	
	The patch also makes bopm set umode -h on itself after opering, in order
	to prevent the bot appearing in /stats p output (shows opers available to
	help).
	
	bopchecker now takes the -c option also, in the same way as bopm.
	
2002-01-23 04:58  strtok

	* ChangeLog:

	ChangeLog: It's 2002!
	
2002-01-22 21:44  strtok

	* bopm.conf.sample:

	bopm.conf.sample: Fixed typo
	
2002-01-22 19:09  strtok

	* ChangeLog:

	ChangeLog: Added changelog
	
